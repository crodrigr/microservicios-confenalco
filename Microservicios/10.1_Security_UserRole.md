# Usuario y role

Todo sistema para su modulo de seguridad se basa en usuarios y roles. Por lo tanto, se debe crear la clase de tipo **entity user y role**

<br>

![image](https://github.com/crodrigr/microservicios-spring-boot-confenalco/assets/31961588/410017b0-cf8d-4a39-a5f9-1103e16046f7)

<br>

## 1. Servicio usuario commons

Se crea un proyecto **servicio-usuario-commons** con las clases de tipo entity **Usuario** y **Role**

![image](https://github.com/crodrigr/microservicios-spring-boot-confenalco/assets/31961588/966dbd1e-2020-433c-a6cc-933343a4e630)

<br>
<br>
<br>


## 2. Role

Se crea la clase **entity role** dentro de paquete **models** y **entities**

![image](https://github.com/crodrigr/microservicios-spring-boot-confenalco/assets/31961588/224bda73-8f1b-4728-b8a7-8ba77766e115)

<br>
<br>
<br>

## 3. Usuario

Se crea la clase **entity usuario** dentro de paquete **models** y **entities**.

Relación de muchos a muchos (`@ManyToMany`) entre dos entidades en una base de datos relacional, utilizando JPA (Java Persistence API) y la anotación `@JoinTable` para configurar la tabla de unión que representa la relación en la base de datos.

Aquí está el significado de cada parte del código:

1. `@ManyToMany(fetch = FetchType.LAZY)`: Esta anotación se coloca en una propiedad de una entidad para definir una relación de muchos a muchos con otra entidad. En este caso, la entidad actual tendrá una colección de objetos de la entidad relacionada. `FetchType.LAZY` indica que la colección no se cargará automáticamente cuando se recupera la entidad principal, sino que se cargarán solo cuando se acceda a ella por primera vez (carga perezosa).

2. `@JoinTable(name = "usuarios_roles", joinColumns = @JoinColumn(name = "usuario_id"), inverseJoinColumns = @JoinColumn(name = "role_id"))`: Esta anotación se utiliza para definir la tabla de unión que representa la relación de muchos a muchos en la base de datos. La tabla de unión se utiliza para almacenar las relaciones entre las entidades `Usuario` y `Role`. `name` especifica el nombre de la tabla de unión (en este caso, "usuarios_roles"). `joinColumns` define la columna que hace referencia a la clave primaria de la entidad `Usuario`, y `inverseJoinColumns` define la columna que hace referencia a la clave primaria de la entidad `Role`.

3. `uniqueConstraints = {@UniqueConstraint(columnNames = { "usuario_id", "role_id" }) }`: Esta parte define una restricción única en la tabla de unión para garantizar que no haya duplicados en la relación entre `Usuario` y `Role`. La restricción única se basa en las columnas "usuario_id" y "role_id", lo que significa que no puede haber la misma combinación de usuario y rol en la tabla de unión más de una vez.

En resumen, esta configuración define una relación de muchos a muchos entre las entidades `Usuario` y `Role`, utilizando una tabla de unión llamada "usuarios_roles" para representar la relación. La tabla de unión tiene dos columnas que hacen referencia a las claves primarias de las entidades `Usuario` y `Role`. Además, se ha configurado una restricción única para evitar duplicados en la tabla de unión.

Recuerda genera los métodos **getter** y **setter**

![image](https://github.com/crodrigr/microservicios-spring-boot-confenalco/assets/31961588/a0fcaaf9-d1ad-4486-84c3-86e7be427c34)

<br>
<br>
<br>
